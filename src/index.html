<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Save the reef</title>
  </head>
  <body>
    <!-- scene-controller  -->
    <a-scene simple-navmesh="radius: 38; coralRadius: 10" fog="type: exponential; color: #0C4B5F; near: 0.5; far: 60; density: 0.001" shadow="type: pcfsoft">
      <a-assets>
        <img id="sandTexture" src="assets/sand.jpg">
        <img id="skybox" src="assets/skybox.png">
        <a-asset-item id="triplets-model" src="assets/triplets.glb"></a-asset-item>
        <a-asset-item id="coral-model" src="assets/coral.glb"></a-asset-item>
        <a-asset-item id="plant-model" src="assets/water-plant.glb"></a-asset-item>
        
        <a-asset-item id="coral-agaricia-agaricites" src="assets/coral/agaricia-agaricites.glb"></a-asset-item>
        <!-- <a-asset-item id="coral-agaricia-agaricites-obj" src="assets/coral/agaricia-agaricites-light.obj"></a-asset-item>
        <a-asset-item id="coral-agaricia-agaricites-mtl" src="assets/coral/agaricia-agaricites-light.mtl"></a-asset-item> -->
      </a-assets>

      <!-- Underwater floor with sand texture -->
      <a-circle id="floor" position="0 0 -4" rotation="-90 0 0" radius="40" segments="80" 
               material="src: #sandTexture; repeat: 5 5" shadow="receive: true"></a-circle>

      <!-- Stationary caustics effect using custom shader -->
      <a-circle position="0 0.01 -4" rotation="-90 0 0" radius="40" segments="80" 
               material="shader: stationary-caustics; color: #00aaff; transparent: true; blending: additive" shadow="receive: true"></a-circle>

      <!-- Water surface -->
      <!-- <a-circle position="0 20 -4" rotation="-90 0 0" radius="40" segments="80" 
               material="shader: water-surface; color: #7AD7F0; transparent: true; side: double"></a-circle> -->

      <!-- Bubble particle system -->
      <a-entity bubbles="count: 220; color: #e0e0ff; size: 0.02; speed: 0.2; opacity: 0.3" position="-2 -0.1 -3"></a-entity>
      <a-entity bubbles="count: 150; color: #e0e0ff; size: 0.01; speed: 0.1; opacity: 0.2" position="2 -0.15 -3"></a-entity>
      <a-entity bubbles="count: 150; color: #e0e0fd; size: 0.01; speed: 0.1; opacity: 0.2" position="3 0.5 -2"></a-entity>


      <a-entity id="triplets" gltf-model="#triplets-model" position="0 -1.5 0" scale="1.3 1.3 1.3">     
        <!-- <a-entity id="plant" animation-mixer="loop: repeat; timeScale:0.4" surface-placer="position: -1.98 0.00005 14.55; normal: 0 0 0; scale: 0.01; leeway: -0.47"
        gltf-model="#plant-model" ></a-entity>
        <a-entity id="plant2" animation-mixer="loop: repeat; startAt: 20; timeScale:0.3" surface-placer="position: -0.427 3.668 13.81; normal: 0 0 0; scale: 0.01; leeway: -0.49"
        gltf-model="#plant-model" > </a-entity>    -->
        
        <a-entity id="coral1" surface-placer="position: 1.03 8.23 15.34; normal: -0.06 0.83 -0.56; scale: 6; leeway: 0.3"
                    gltf-model="#coral-model" ocean-shader="colorStrength: 0.1">
        </a-entity>
        <a-entity id="coral2" surface-placer="position: -2.88 7.15 14.03; normal: 0.08 0.82 -0.57; leeway: 0.3; scale: 1"
        gltf-model="#coral-agaricia-agaricites" ocean-shader></a-entity>
        
        <!-- <a-entity id="coral2" surface-placer="position: -2.88 7.15 14.03; normal: 0.08 0.82 -0.57; leeway: 0.3; scale: 1"
            rotation="0 70 0.1" obj-model="obj: #coral-agaricia-agaricites-obj; mtl: #coral-agaricia-agaricites-mtl" > -->


        </a-entity>
      </a-entity> 
      <a-entity light="type: directional; color: #FFF; intensity: 0.6; target: #rock" position="1 1 1"></a-entity>

      <a-entity light="type: directional; color: #FFF; intensity: 0.6; target: #coral2" position="1 1 1"></a-entity>
      
      <!-- Ambient light to simulate underwater lighting -->
      <a-light type="ambient" color="#0C4B5F" intensity="0.3"></a-light>

      <!-- Directional light to enhance the caustics effect and cast shadows -->
      <a-light id="light-floor" type="directional" target="#floor" color="#ffffff" intensity="0.9" position="-1 19 -21" castShadow="true" 
               shadow="mapSize: 2048x2048; bias: -0.001; near: 0.3; far: 50"></a-light>
            
      <!-- Underwater sky color -->
      <a-sky src="#skybox" ></a-sky>

      <!-- Camera -->
      <a-entity id="player-camera" camera="near: 0.01; far: 10000" position="0 8 25" 
          look-controls="pointerLockEnabled: true"
          custom-wasd-controls="speed: 20"
          simple-float="amplitude: 0.8; speed: 3; horizontalDrift: 0.05; minHeight: 0.8; tiltAmount: 5">
      </a-entity>

    </a-scene>
  </body>
</html>